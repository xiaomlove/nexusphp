var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,r=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,s=(e,s)=>{for(var d in s||(s={}))a.call(s,d)&&r(e,d,s[d]);if(t)for(var d of t(s))l.call(s,d)&&r(e,d,s[d]);return e};import{k as d,r as o,A as n,o as i,a as m,s as u,t as f,v as p,x as c,u as _,q as g,p as b,m as D,b as V,d as y,e as Y,f as h,F as x,i as v,g as U,h as j,z as H,j as M}from"./index.815ab905.js";const k={name:"ExamForm",setup(){const{proxy:e}=p();console.log("proxy",e);const a=d(null),t=c(),l=_(),{id:r}=t.query,b=o({token:n("token")||"",id:r,allClasses:[],formData:{name:"",description:"",begin:"",end:"",duration:"",indexes:[],filters:{classes:[],register_time_range:[],donate_status:[]},status:"",is_discovered:""},rules:{name:[{required:"true"}],indexes:[{required:"true"}],status:[{required:"true"}],is_discovered:[{required:"true"}]}});i((async()=>{await D(),await V(),r&&m.getExam(r).then((e=>{b.formData.name=e.data.name,b.formData.description=e.data.description,b.formData.begin=e.data.begin,b.formData.end=e.data.end,b.formData.duration=e.data.duration,b.formData.indexes=e.data.indexes,b.formData.filters=e.data.filters,b.formData.status=e.data.status,b.formData.is_discovered=e.data.is_discovered}))})),u((()=>{}));const D=async()=>{let e=await m.listClass();b.allClasses=e.data},V=async()=>{let e=await m.listExamIndex();b.formData.indexes=e.data};return s(s({},f(b)),{formRef:a,submitAdd:()=>{a.value.validate((async e=>{if(e){let e=b.formData;console.log(e),e.begin&&(e.begin=dayjs(e.begin).format("YYYY-MM-DD HH:mm:ss")),e.end&&(e.end=dayjs(e.end).format("YYYY-MM-DD HH:mm:ss")),e.filters.register_time_range&&e.filters.register_time_range[0]&&(e.filters.register_time_range[0]=dayjs(e.filters.register_time_range[0]).format("YYYY-MM-DD HH:mm:ss")),e.filters.register_time_range&&e.filters.register_time_range[1]&&(e.filters.register_time_range[1]=dayjs(e.filters.register_time_range[1]).format("YYYY-MM-DD HH:mm:ss")),console.log(e),r?await m.updateExam(r,e):await m.storeExam(e),await l.push({name:"exam"})}}))},handleBeforeUpload:e=>{const a=e.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(a))return g.error("请上传 jpg、jpeg、png 格式的图片"),!1},handleUrlSuccess:e=>{b.formData.goodsCoverImg=e.data||""},handleChangeCate:e=>{b.categoryId=e[2]||0}})}},w=M();b("data-v-bbfb36a6");const E=U("Enabled"),q=U("Disabled"),C=U("No"),O=U("Yes"),I=h("div",{style:{color:"#aaa"}},"Unit: days. When assign to user, begin and end are used if they are specified. Otherwise begin time is the time at assignment, and the end time is the time at assignment plus the duration.",-1),S=U("No"),T=U("Yes"),B=U("Submit");D();const A=w(((e,a,t,l,r,s)=>{const d=V("el-input"),o=V("el-form-item"),n=V("el-checkbox"),i=V("el-col"),m=V("el-row"),u=V("el-radio"),f=V("el-radio-group"),p=V("el-date-picker"),c=V("el-checkbox-group"),_=V("el-button"),g=V("el-form");return y(),Y("div",null,[h(m,null,{default:w((()=>[h(i,{span:12},{default:w((()=>[h(g,{model:e.formData,rules:e.rules,ref:"formRef","label-width":"200px",class:"formData"},{default:w((()=>[h(o,{label:"Name",prop:"name"},{default:w((()=>[h(d,{modelValue:e.formData.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.name=a),placeholder:""},null,8,["modelValue"])])),_:1}),h(o,{label:"Index",prop:"indexes"},{default:w((()=>[(y(!0),Y(x,null,v(e.formData.indexes,((e,a)=>(y(),Y(m,{key:a},{default:w((()=>[h(i,{span:6},{default:w((()=>[h(n,{modelValue:e.checked,"onUpdate:modelValue":a=>e.checked=a,label:e.checked},{default:w((()=>[U(j(e.name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","label"])])),_:2},1024),h(i,{span:12},{default:w((()=>[h(d,{type:"number",modelValue:e.require_value,"onUpdate:modelValue":a=>e.require_value=a},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),h(i,{span:6,style:{padding:"0 20px",color:"#aaa"}},{default:w((()=>[e.unit?(y(),Y(x,{key:0},[U(" Unit: "+j(e.unit),1)],64)):H("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),h(o,{label:"Status",prop:"status"},{default:w((()=>[h(f,{modelValue:e.formData.status,"onUpdate:modelValue":a[2]||(a[2]=a=>e.formData.status=a)},{default:w((()=>[h(u,{label:0},{default:w((()=>[E])),_:1}),h(u,{label:1},{default:w((()=>[q])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Discovered",prop:"is_discovered"},{default:w((()=>[h(f,{modelValue:e.formData.is_discovered,"onUpdate:modelValue":a[3]||(a[3]=a=>e.formData.is_discovered=a)},{default:w((()=>[h(u,{label:0},{default:w((()=>[C])),_:1}),h(u,{label:1},{default:w((()=>[O])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Begin",prop:"begin"},{default:w((()=>[h(p,{modelValue:e.formData.begin,"onUpdate:modelValue":a[4]||(a[4]=a=>e.formData.begin=a),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Begin Time"},null,8,["modelValue"])])),_:1}),h(o,{label:"End",prop:"end"},{default:w((()=>[h(p,{modelValue:e.formData.end,"onUpdate:modelValue":a[5]||(a[5]=a=>e.formData.end=a),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select End Time"},null,8,["modelValue"])])),_:1}),h(o,{label:"Duration",prop:"duration"},{default:w((()=>[h(d,{modelValue:e.formData.duration,"onUpdate:modelValue":a[6]||(a[6]=a=>e.formData.duration=a),type:"number",placeholder:""},null,8,["modelValue"]),I])),_:1}),h(o,{label:"Target user class",prop:"filters.classes"},{default:w((()=>[h(c,{modelValue:e.formData.filters.classes,"onUpdate:modelValue":a[7]||(a[7]=a=>e.formData.filters.classes=a)},{default:w((()=>[(y(!0),Y(x,null,v(e.allClasses,((e,a)=>(y(),Y(n,{label:a,key:a},{default:w((()=>[U(j(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Target user donated",prop:"filters.donate_status"},{default:w((()=>[h(c,{modelValue:e.formData.filters.donate_status,"onUpdate:modelValue":a[8]||(a[8]=a=>e.formData.filters.donate_status=a)},{default:w((()=>[h(n,{label:"no"},{default:w((()=>[S])),_:1}),h(n,{label:"yes"},{default:w((()=>[T])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Target user register time"},{default:w((()=>[h(p,{modelValue:e.formData.filters.register_time_range,"onUpdate:modelValue":a[9]||(a[9]=a=>e.formData.filters.register_time_range=a),type:"datetimerange",format:"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Begin","end-placeholder":"End"},null,8,["modelValue"])])),_:1}),h(o,{label:"Description",prop:"description"},{default:w((()=>[h(d,{type:"textarea",modelValue:e.formData.description,"onUpdate:modelValue":a[10]||(a[10]=a=>e.formData.description=a),placeholder:""},null,8,["modelValue"])])),_:1}),h(o,null,{default:w((()=>[h(_,{type:"primary",onClick:a[11]||(a[11]=e=>l.submitAdd())},{default:w((()=>[B])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])}));k.render=A,k.__scopeId="data-v-bbfb36a6";export default k;
